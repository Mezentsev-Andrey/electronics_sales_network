# Проект "Онлайн платформа торговой сети электроники"

Данный проект представляет собой веб-приложение с API-интерфейсом и админ-панелью модели сети по продаже электроники.

## О проекте

Бэкенд обеспечивает API для работы просмотра, создания, редактирования, удаления сетевых звеньев - поставщиков электронной продукции в рамках модели сети по продаже электроники.

Сеть представляет собой иерархическую структуру из трех уровней:
- завод;
- розничная сеть;
- индивидуальный предприниматель.

Каждое звено сети ссылается только на одного поставщика оборудования (не обязательно предыдущего по иерархии). Важно отметить, что уровень иерархии определяется не названием звена, а отношением к остальным элементам сети, т. е. завод всегда находится на уровне 0, а если розничная сеть относится напрямую к заводу, минуя остальные звенья, ее уровень - 1.

## Возможности

- Регистрация и авторизация пользователей;
- Создание, чтение, обновление и удаление сетевых звеньев и электронной продукции в соответствии с поставленными задачами пользователей;
- Просмотр списка сетевых звеньев и связанных с ними перечнем электронной продукции;
- Просмотр списка электронной продукции продающейся в пределах торговой сети.

## Технологии

- Python;
- Django (Django Rest Framework, Celery);
- PostgreSQL (БД для хранения данных);
- Docker.

## Запуск проекта

1. Установите зависимости:
    - `pip install -r requirements.txt`

2. Создайте файл `.env` в корневой директории и заполните необходимые переменные окружения:
    
   2.1. Настройка: 
    - POSTGRES_DB=`"имя базы данных"`;
    - POSTGRES_USER=`"пользователь базы данных"`;
    - POSTGRES_PASSWORD=`"пароль базы данных"`;
    - POSTGRES_PORT=`"порт базы данных"`;
    - POSTGRES_HOST=`"хост базы данных"`.
   
    2.2. Настройка Celery:
    - CELERY_BROKER_URL=`"URL брокера Celery"`;
    - CELERY_RESULT_BACKEND=`"URL бэкенда Celery"`.

3. Примените миграции:
    - `python manage.py migrate`

4. Запустите сервер:
    - `python manage.py runserver`

5. Запустите Celery для обработки отложенных задач:
    - `celery -A config worker -l INFO -P eventlet`
    - `celery -A config beat -l INFO`

6. Запуск приложения:
    - Заполнение базы данных произведено в админке. Загруженные данные представлены по адресу: network/fixtures/all_data.json, network/fixtures/network_data.json; users/fixtures/users_data.json. Для их загрузки в базу данных проекта воспользуйтесь командой: `python manage.py loaddatautf8 network_data.json`
    - Для выгрузки данных из базы данных проекта используйте команду: `python manage.py dumpdatautf8 network --output network/fixtures/modules_data.json` (в данном примере команды приведена выгрузка всех данных из приложения network.)
    - Создать суперпользователя кастомной командой `python manage.py csu`.

7. Виды запросов в Postman: 

   Запросы в Postman для сетевых звеньев:
    - POST: создание сетевого звена: http://localhost:8000/network/create/ (заполнить тело, выбрав параметры 'raw' и 'json'; обязательные поля: 'title', 'email');
    - GET: получение списка сетевых звеньев: http://localhost:8000/network/list/;
    - GET: получение информации о конкретном сетевом звене: http://localhost:8000/network/retieve/<pk звена>/;
    - PUT: обновление сетевого узла: http://localhost:8000/network/update/<pk звена>/ (заполнить тело, выбрав параметры 'raw' и 'json');
    - DELETE: удаление сетевого узла: http://localhost:8000/network/delete/<pk звена>/.
   
   Запросы в Postman для электронной продукции:
    - POST: создание продукта электроники: http://localhost:8000/product/ (заполнить тело, выбрав параметры 'raw' и 'json'; обязательное поле: 'title);
    - GET: получение списка электронных товаров: http://localhost:8000/product/;
    - GET: получение информации о конкретном продукте электроники: http://localhost:8000/product/<pk продукта>/;
    - PUT: обновление продукта электроники: http://localhost:8000/product/<pk продукта>/ (заполнить тело, выбрав параметры 'raw' и 'json');
    - DELETE: удаление продукта электроники: http://localhost:8000/product/<pk продукта>.
   
8. Регистрация нового пользователя: 
   - POST: http://localhost:8000/users/user/ (заполнить тело, выбрав параметры 'raw' и 'json', обязательные поля: email, password).
9. После регистрации пользователя нужно войти в приложение с помощью логина (email) и пароля сделав соответствующий запрос:
   - POST: http://localhost:8000/users/login/

## Документация API

Документация API доступна после запуска сервера по адресам: http://localhost:8000/redoc/ и http://localhost:8000/swagger/

## Запуск проекта с использованием Docker
  - Используйте файлы Dockerfile и docker-compose.yml. При необходимости внесите в них требуемые изменения;
  - Соберите образ с помощью команды: `docker-compose build`;
  - Запустите контейнеры с помощью команды: `docker-compose up`;
  - Управление контейнерами: Для остановки и удаления контейнеров используйте Ctrl + C в терминале, где запущен docker-compose up. Для остановки контейнеров и удаления созданных ресурсов выполните команду: `docker-compose down`;
  - Если при запуске контейнера добавить флаг -d, процесс запустится в фоновом режиме (как демон). В случае, если к команде добавить флаг --build, то перед запуском выполнится сборка. В итоге команда будет выглядеть так: `docker-compose up -d --build`.
